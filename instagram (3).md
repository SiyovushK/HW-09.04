# üèõ –ó–∞–¥–∞–Ω–∏–µ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é API –¥–ª—è Instagram

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞–π—Ç–µ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ Instagram (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–æ—Å—Ç—ã, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º C# –∏ Entity Framework Core. –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL, –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –º–æ–¥–µ–ª–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DTO, –ø–æ–¥–∫–ª—é—á–∏—Ç—å Swagger –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º JOIN-–∑–∞–ø—Ä–æ—Å–æ–≤.

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
1. **Domain** ‚Äî –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö.  
2. **Infrastructure** ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç EF Core, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –º–∏–≥—Ä–∞—Ü–∏–∏.  
3. **WebAPI** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Swagger –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ.

---

## 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### üë§ User
| –ü–æ–ª–µ       | –¢–∏–ø           | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–≤–æ–π—Å—Ç–≤–∞                              |
|------------|---------------|-----------------------------------------------------|
| `Id`       | `int`         | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á                                      |
| `Username` | `string`      | **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ**, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ, –º–∞–∫—Å. –¥–ª–∏–Ω–∞ 50       |
| `Email`    | `string`      | **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ**, –º–∞–∫—Å. –¥–ª–∏–Ω–∞ 100                  |
| `Bio`      | `string`      | –ú–∞–∫—Å. –¥–ª–∏–Ω–∞ 200                                    |
| `Posts`    | `List<Post>`  | –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ                             |

---

### üì∑ Post
| –ü–æ–ª–µ        | –¢–∏–ø           | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–≤–æ–π—Å—Ç–≤–∞                              |
|-------------|---------------|-----------------------------------------------------|
| `Id`        | `int`         | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á                                      |
| `UserId`    | `int`         | –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á (—Å—Å—ã–ª–∫–∞ –Ω–∞ `User`)                    |
| `Content`   | `string`      | **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ**, –º–∞–∫—Å. –¥–ª–∏–Ω–∞ 500                  |
| `CreatedAt` | `DateTime`    | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è                                      |
| `User`      | `User`        | –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ                             |
| `Comments`  | `List<Comment>` | –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ                           |

---

### üí¨ Comment
| –ü–æ–ª–µ        | –¢–∏–ø           | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–≤–æ–π—Å—Ç–≤–∞                              |
|-------------|---------------|-----------------------------------------------------|
| `Id`        | `int`         | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á                                      |
| `UserId`    | `int`         | –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á (—Å—Å—ã–ª–∫–∞ –Ω–∞ `User`)                    |
| `PostId`    | `int`         | –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á (—Å—Å—ã–ª–∫–∞ –Ω–∞ `Post`)                    |
| `Text`      | `string`      | **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ**, –º–∞–∫—Å. –¥–ª–∏–Ω–∞ 300                  |
| `CreatedAt` | `DateTime`    | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è                                      |
| `User`      | `User`        | –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ                             |
| `Post`      | `Post`        | –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ                             |

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –º–æ–¥–µ–ª—è–º
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Data Annotations** (`[Required]`, `[StringLength]`, `[Key]`) –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –ø–æ–ª—è.  
- –ü—Ä–æ–¥—É–±–ª–∏—Ä—É–π—Ç–µ —ç—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ **Fluent API** –≤ –º–µ—Ç–æ–¥–µ `OnModelCreating`.  
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–≤—è–∑–∏ –æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º (`User` ‚Üí `Posts`, `Post` ‚Üí `Comments`, `User` ‚Üí `Comments`) —Å –ø–æ–º–æ—â—å—é **Fluent API**.

---

## 2. CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ üõ†Ô∏è
- –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:  
  - `UsersController`  
  - `PostsController`  
  - `CommentsController`  
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥—ã:  
  - `GET /users`, `GET /users/{id}` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ ID.  
  - `POST /users` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
  - `PUT /users/{id}` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
  - `DELETE /users/{id}` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
  - –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è `Posts` –∏ `Comments`.

---

## 3. DTO
–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ DTO –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏:  

### `UserDto`
- `Id` (int)  
- `Username` (string)  
- `Email` (string)  
- `PostCount` (int) ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  

### `PostDto`
- `Id` (int)  
- `UserId` (int)  
- `Username` (string) ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ `User`  
- `Content` (string)  
- `CreatedAt` (DateTime)  
- `CommentCount` (int) ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤  

### `CommentDto`
- `Id` (int)  
- `UserId` (int)  
- `Username` (string) ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ `User`  
- `PostId` (int)  
- `Text` (string)  
- `CreatedAt` (DateTime)  

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ DTO –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤.

---

## 4. Swagger üìú
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç `Swashbuckle.AspNetCore`.  
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `Program.cs`, —á—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API.

---

## 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
### `appsettings.json`
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=instagramdb;Username=admin;Password=pass123"
  }
}
```
- –í `Program.cs` –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ `DbContext` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:  
  ```csharp
  builder.Services.AddDbContext<InstagramContext>(options => 
      options.UseNpgsql(builder.Configuration.GetConnectionString("DefaultConnection")));
  ```

---
–í–æ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –±–ª–æ–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏, –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å–Ω–æ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ: —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, —Ç–∞–±–ª–∏—Ü–∞–º–∏ –¥–ª—è DTO, –∂–∏—Ä–Ω—ã–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤ –∏ —ç–º–æ–¥–∑–∏ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏. –ö–∞–∂–¥–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ DTO, –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª.

---

## 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è üéØ

### 1. **GET /posts/latest**  
–°–æ–∑–¥–∞–π—Ç–µ endpoint, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ—Å—Ç–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –Ω–æ–≤—ã–π **DTO** –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–∞–ø—Ä–æ—Å —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π.  

- **DTO**: `LatestPostsDto`  
  | –ü–æ–ª–µ         | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                     |  
  |--------------|------------|------------------------------|  
  | `Content`    | `string`   | –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞                 |  
  | `CreatedAt`  | `DateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞         |  
  | `Username`   | `string`   | –ò–º—è –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞            |  
- –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Å—Ç—ã –ø–æ **CreatedAt** (–æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º).  

---

### 2. **GET /users/{id}/all-posts**  
–†–µ–∞–ª–∏–∑—É–π—Ç–µ endpoint, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –ø–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π **DTO** –∏ —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ `User` –∏ `Post`.  

- **DTO**: `UserPostsDto`  
  | –ü–æ–ª–µ         | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                     |  
  |--------------|------------|------------------------------|  
  | `Content`    | `string`   | –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞                 |  
  | `CreatedAt`  | `DateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞         |  
  | `Username`   | `string`   | –ò–º—è –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞            |  

---

### 3. **GET /posts/{id}/with-author**  
–î–æ–±–∞–≤—å—Ç–µ endpoint, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –ø–æ –µ–≥–æ ID. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π **DTO** –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.  

- **DTO**: `PostAuthorDto`  
  | –ü–æ–ª–µ         | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                     |  
  |--------------|------------|------------------------------|  
  | `Content`    | `string`   | –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞                 |  
  | `CreatedAt`  | `DateTime` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞         |  
  | `Username`   | `string`   | –ò–º—è –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞            |  

---

### 4. **GET /users/top-posters**  
–†–µ–∞–ª–∏–∑—É–π—Ç–µ endpoint, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å—Ç–æ–≤. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –Ω–æ–≤—ã–π **DTO** –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É.  

- **DTO**: `TopPosterDto`  
  | –ü–æ–ª–µ         | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                     |  
  |--------------|------------|------------------------------|  
  | `Username`   | `string`   | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è            |  
  | `Email`      | `string`   | Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è          |  
  | `PostCount`  | `int`      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤           |  
- –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ **PostCount** (–ø–æ —É–±—ã–≤–∞–Ω–∏—é).  

---

### 5. **GET /posts/{id}/comments-with-users**  
–°–æ–∑–¥–∞–π—Ç–µ endpoint, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å—Ç –∏ –≤—Å–µ –µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π **DTO** —Å –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.  

- **DTO**: `PostCommentsDto`  
  | –ü–æ–ª–µ           | –¢–∏–ø                   | –û–ø–∏—Å–∞–Ω–∏–µ                     |  
  |----------------|-----------------------|------------------------------|  
  | `Content`      | `string`             | –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞                 |  
  | `Username`     | `string`             | –ò–º—è –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞            |  
  | `Comments`     | `List<CommentInfo>`  | –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤         |  

  - –í–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç `CommentInfo`:  
    | –ü–æ–ª–µ           | –¢–∏–ø        | –û–ø–∏—Å–∞–Ω–∏–µ                     |  
    |----------------|------------|------------------------------|  
    | `Text`         | `string`   | –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è           |  
    | `CommentAuthor`| `string`   | –ò–º—è –∞–≤—Ç–æ—Ä–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è      |  

---

## –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å –Ω—É–ª—è, —Ä–∞–∑–¥–µ–ª–∏–≤ –µ–≥–æ –Ω–∞ —Å–ª–æ–∏ (`Domain`, `Infrastructure`, `WebAPI`).  
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.  
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Å–≤—è–∑–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.  
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É API —á–µ—Ä–µ–∑ Swagger.
